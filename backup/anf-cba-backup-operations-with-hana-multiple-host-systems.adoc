---
sidebar: sidebar 
permalink: backup/anf-cba-backup-operations-with-hana-multiple-host-systems.html 
keywords: system replication, cba, hsr, multiple host, standby host 
summary: 本節說明如何使用HANA系統複寫來執行備份作業。 
---
= 使用HANA多主機系統進行備份作業
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/


link:anf-cba-backup-operations-with-hana-system-replication.html["先前版本：HANA系統複寫的備份作業。"]

HANA資料庫執行Snapshot備份的方式與單一主機系統相同。必須在系統資料庫中觸發備份作業SQL命令、並為所有HANA工作節點建立HANA備份儲存點、使每個節點的所有資料磁碟區都保持一致。接下來、儲存Snapshot作業必須在每個資料磁碟區上執行。



== Hana多主機系統、無需待命主機

沒有待命主機的HANA多主機系統在CBA中的設定方式類似於HANA單一主機系統。

. HANA外掛程式必須安裝在執行HANA名稱伺服器和系統資料庫的工作節點上。執行Indexserver的工作節點不需要HANA外掛程式。
. HDB使用者儲存金鑰的設定方式與HANA單一主機系統相同。
. 在儲存設備實體佔用空間的組態中、必須新增HANA系統的所有資料磁碟區。
+
在下列範例中、您將新增Data1、Data2和Data3磁碟區。

+

NOTE: 每個HANA主機的資料磁碟區必須以待命主機組態的相同方式掛載於每個主機上。Cloud Backup for Applications會建立備份所含檔案的清單、因此需要存取屬於HANA系統的所有磁碟區。啟用ANF跨區域複寫或ANF備份時、單一檔案還原作業需要檔案清單。

+
image:anf-cba-image111.png["此圖顯示HANA外掛程式必須安裝在執行Nameserver/systemDB的工作節點上的方式。"]





== Hana多主機系統與待命主機

在目前的CBA版本中、支援使用待命主機的HANA多主機系統時、假設在名稱伺服器容錯移轉至待命主機之後、故障主機會重新啟動、然後出現相同的作業系統組態、檔案系統掛載和HANA外掛。

在CBA中設定具有待命主機的HANA多主機系統、並執行下列步驟。

. HANA外掛程式必須安裝在執行HANA名稱伺服器/系統資料庫的工作節點上。
. HDB使用者存放區金鑰設定為兩部主機、系統資料庫（名稱伺服器主機）和待命主機。CBA金鑰組態中的主機：連接埠字串必須以分號分隔、而且清單必須以雙引號開頭和結尾。然後hdbsql用戶端會從使用者存放區金鑰的第一個項目開始、並嘗試連線至資料庫。如果該項目無法運作、則會使用下一個項目。因此、將主要名稱伺服器主機設定為第一個、將待命主機設定為使用者存放區金鑰中的第二個項目、是非常重要的。
+
image:anf-cba-image112.png["此螢幕快照顯示「新增使用者儲存區」畫面、並填入適當的資訊。"]

. HANA系統的所有資料磁碟區都必須新增至儲存設備佔用空間的組態。
+
在下圖所示範例中、您需要新增Data1和Data2磁碟區。

+
image:anf-cba-image113.png["此圖顯示如何將Data1和Data2新增至工作者名稱伺服器和待命模式。"]



如果名稱伺服器容錯移轉至待命主機、則會假設故障主機會在短時間內重新啟動、並與之前相同的組態。在此案例中、HANA外掛程式和hdbsql和hdb使用者存放區元件可供使用、並可繼續用於備份作業。

使用之前所述的使用者存放區組態、hdbsql用戶端現在會使用第二個主機項目來指向目前的名稱伺服器主機、並執行備份作業。

image:anf-cba-image114.png["此圖顯示故障的VM會重新啟動、並在容錯移轉至待命主機後做為新的待命主機。"]

link:anf-cba-where-to-find-additional-information-and-version-history.html["下一步：何處可以找到其他資訊和版本歷程記錄。"]
