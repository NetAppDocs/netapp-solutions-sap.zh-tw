---
sidebar: sidebar 
permalink: backup/anf-cba-file-based-backup-operations-of-the-hana-database.html 
keywords: assign policy, file-based backup, cba topology, sap hana studio 
summary: 本節說明如何完成HANA資料庫的檔案型備份作業。 
---
= HANA資料庫的檔案型備份作業
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/


link:anf-cba-snapshot-based-backup-operations-of-the-hana-database.html["先前版本：HANA資料庫的Snapshot型備份作業。"]

[role="lead"]
SAP建議結合儲存型Snapshot備份與每週檔案型備份、以執行區塊完整性檢查。Cloud Backup for Applications使用選取檔案型備份做為備份類型的原則、支援執行區塊完整性檢查。

除了HANA資料磁碟區上的Snapshot備份之外、也會使用檔案型備份來建立次要備份複本。當主要資料磁碟區完全遺失時、您可以使用這些檔案型備份來進行還原與還原作業。

使用此原則排程備份時、Cloud Backup for Applications會為系統和所有租戶資料庫建立標準SAP HANA檔案備份。



== 指派原則給HANA系統

若要啟動排程備份、必須將備份原則指派給HANA系統。

. 轉至*指派原則*>*資料磁碟區*。
+
image:anf-cba-image48.png["正在完成步驟的快照。"]

. 選取檔案型備份原則、然後按一下*指派*。
+
image:anf-cba-image49.png["正在完成步驟的快照。"]

. 此原則現已指派給HANA系統、並會根據排程定義執行檔案型備份。




== 建立隨需檔案型備份

若要建立隨需資料庫備份、請完成下列步驟：

. 在CBA儀表板檢視中、選取內容功能表中的隨需備份–資料Volume。
+
image:anf-cba-image50.png["正在完成步驟的快照。"]

. 在「隨需備份」對話方塊中、選取*原則型*或*一次*。
+
** 使用*原則型*時、隨需備份的處理方式與排程備份的保留與指令碼前及指令碼後組態相同。
** 使用*一次*、您可以定義特定的保留、特定的備份名稱、以及特定的指令碼前後。


. 在我們的範例中、我們選擇了原則型、並將原則和保留選為下一步。
+
image:anf-cba-image51.png["正在完成步驟的快照。"]

. 在「工作監控」檢視中、您可以看到不同的工作流程步驟、步驟的執行時間、以及總作業執行時間。
+
image:anf-cba-image52.png["正在完成步驟的快照。"]

+
image:anf-cba-image53.png["正在完成步驟的快照。"]





== 在CBA拓撲檢視中檢閱檔案型備份資訊

Cloud Backup for Applications不會以與Snapshot複製型備份相同的方式顯示檔案型備份。相反地、只會列出最後一次的檔案型備份。在「工作監控」檢視中可以看到檔案型備份的成功或失敗。

image:anf-cba-image54.png["正在完成步驟的快照。"]



== 檢閱檔案系統上的檔案型備份資訊

成功的區塊完整性檢查可建立標準的SAP HANA資料備份檔案。CBA使用HANA資料庫中設定的備份路徑進行檔案型資料備份作業。命名慣例遵循檔案型備份原則中的組態。

....
vm-pr1:/hanabackup/PR1/file # ls -al *
DB_PR1:
total 3355880
drwxr-xr-- 2 pr1adm sapsys       4096 Jan  3 10:12 .
drwxr-x--- 4 pr1adm sapsys       4096 Dec 19 13:53 ..
-rw-r----- 1 pr1adm sapsys     155648 Jan  3 10:10 SnapCenter_SnapCenter_PR1_WeeklyBlockIntegrityCheck_Weekly_2023_01_03_10_10_19_databackup_0_1
-rw-r----- 1 pr1adm sapsys   83894272 Jan  3 10:11 SnapCenter_SnapCenter_PR1_WeeklyBlockIntegrityCheck_Weekly_2023_01_03_10_10_19_databackup_2_1
-rw-r----- 1 pr1adm sapsys 1627398144 Jan  3 10:12 SnapCenter_SnapCenter_PR1_WeeklyBlockIntegrityCheck_Weekly_2023_01_03_10_10_19_databackup_3_1
SYSTEMDB:
total 3092672
drwxr-xr-- 2 pr1adm sapsys       4096 Jan  3 10:12 .
drwxr-x--- 4 pr1adm sapsys       4096 Dec 19 13:53 ..
-rw-r----- 1 pr1adm sapsys     159744 Jan  3 10:10 SnapCenter_SnapCenter_PR1_WeeklyBlockIntegrityCheck_Weekly_2023_01_03_10_10_19_databackup_0_1
-rw-r----- 1 pr1adm sapsys 1577066496 Jan  3 10:12 SnapCenter_SnapCenter_PR1_WeeklyBlockIntegrityCheck_Weekly_2023_01_03_10_10_19_databackup_1_1
vm-pr1:/hanabackup/PR1/file #
....


== 在SAP HANA Studio中檢閱檔案型備份資訊

SAP HANA備份目錄會顯示系統和租戶資料庫的項目。下圖顯示系統資料庫和租戶資料庫備份目錄中的CBA檔案型備份。

image:anf-cba-image55.png["下圖顯示系統資料庫備份目錄中的CBA檔案型備份。"]

image:anf-cba-image56.png["下圖顯示租戶資料庫備份目錄中的CBA檔案型備份。"]

link:anf-cba-snapshot-based-backup-operations-of-non-data-volumes.html["下一步：非資料磁碟區的Snapshot型備份作業。"]
